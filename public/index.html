<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="regTitle">Tamange Bank - Account Registration</title>
    <script type="importmap">
    {
        "imports": {
            "trusted-issuer-registry": "/node_modules/trusted-issuer-registry/build/trusted-issuer-registry.js",
            "asn1js": "/node_modules/asn1js/build/index.es.js",
            "pkijs": "/node_modules/pkijs/build/index.es.js",
            "cbor2": "/node_modules/cbor2/lib/index.js",
            "@hpke/core": "/node_modules/@hpke/core/esm/mod.js",
            "pvtsutils": "/node_modules/pvtsutils/build/index.es.js",
            "pvutils": "/node_modules/pvutils/build/utils.es.js",
            "bytestreamjs": "/node_modules/bytestreamjs/build/mjs/index.js",
            "@noble/hashes/sha1": "/node_modules/@noble/hashes/esm/sha1.js",
            "@noble/hashes/sha2": "/node_modules/@noble/hashes/esm/sha2.js",
            "@noble/hashes/utils": "/node_modules/@noble/hashes/esm/utils.js",
            "@noble/hashes/crypto": "/node_modules/@noble/hashes/esm/crypto.js",
            "@noble/hashes/_assert": "/node_modules/@noble/hashes/esm/_assert.js",
            "@noble/hashes/_u64": "/node_modules/@noble/hashes/esm/_u64.js",
            "@noble/hashes/_md": "/node_modules/@noble/hashes/esm/_md.js",
            "canonical-json": "/node_modules/canonical-json/index.js",
            "@cto.af/wtf8": "/node_modules/@cto.af/wtf8/lib/index.js",
            "@hpke/common": "/node_modules/@hpke/common/esm/mod.js"
        }
    }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        .bank-header { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); border-radius: 12px; padding: 40px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; position: relative; }
        .bank-logo { font-size: 2.5em; color: white; font-weight: 700; margin-bottom: 10px; letter-spacing: 1px; }
        .bank-tagline { color: rgba(255,255,255,0.9); font-size: 1.1em; font-weight: 300; }
        .nav-links { position: absolute; top: 20px; right: 30px; display: flex; gap: 15px; }
    .lang-select { background: rgba(255,255,255,0.15); color: white; border: 1px solid rgba(255,255,255,0.35); padding: 8px 10px; border-radius: 6px; font-size: 0.9em; font-weight: 600; }
        .nav-link { color: white; text-decoration: none; padding: 8px 16px; border-radius: 6px; font-size: 0.9em; font-weight: 500; transition: background 0.3s; }
        .nav-link:hover { background: rgba(255,255,255,0.2); }
        .nav-link.active { background: rgba(255,255,255,0.3); }
        .card { background: white; border-radius: 12px; padding: 40px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .step-indicator { display: flex; justify-content: space-between; margin-bottom: 40px; padding: 0 20px; }
        .step { flex: 1; text-align: center; padding: 10px; position: relative; color: #9ca3af; font-size: 0.9em; font-weight: 500; }
        .step.active { color: #3b82f6; font-weight: 600; }
        .step.completed { color: #10b981; font-weight: 600; }
        .step::before { content: ''; width: 30px; height: 30px; border-radius: 50%; background: #e5e7eb; position: absolute; top: -40px; left: 50%; transform: translateX(-50%); border: 3px solid white; }
        .step.active::before { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .step.completed::before { background: linear-gradient(135deg, #10b981, #059669); }
        .step::after { content: ''; position: absolute; top: -25px; right: -50%; width: 100%; height: 3px; background: #e5e7eb; z-index: -1; }
        .step:last-child::after { display: none; }
        .step.completed::after { background: linear-gradient(90deg, #10b981, #3b82f6); }
        h2 { color: #1f2937; margin-bottom: 20px; font-size: 1.8em; font-weight: 700; }
        h3 { color: #374151; font-size: 1.2em; font-weight: 600; }
        .btn-primary { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; padding: 16px 32px; font-size: 16px; font-weight: 600; border-radius: 8px; cursor: pointer; width: 100%; transition: all 0.3s; box-shadow: 0 4px 12px rgba(59,130,246,0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(59,130,246,0.4); }
        .btn-primary:disabled { background: #d1d5db; cursor: not-allowed; transform: none; box-shadow: none; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #374151; font-weight: 600; font-size: 0.95em; }
        .form-group input, .form-group select { width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 15px; transition: all 0.2s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .form-group small { color: #6b7280; font-size: 0.85em; display: block; margin-top: 4px; }
        .account-types { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .account-type { border: 2px solid #e5e7eb; padding: 24px; border-radius: 12px; cursor: pointer; text-align: center; transition: all 0.3s; background: #fafafa; }
        .account-type:hover { border-color: #3b82f6; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(59,130,246,0.1); }
        .account-type.selected { border-color: #3b82f6; background: linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,197,253,0.1) 100%); box-shadow: 0 4px 12px rgba(59,130,246,0.2); }
        .account-type h3 { color: #1f2937; margin-bottom: 10px; font-size: 1.3em; }
        .account-type p { color: #6b7280; font-size: 0.95em; margin-bottom: 8px; }
        .account-type .highlight { color: #3b82f6; font-weight: 700; font-size: 1.1em; margin-top: 12px; }
        .info-box { background: linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,197,253,0.1) 100%); padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 4px solid #3b82f6; }
        .info-box p { color: #374151; line-height: 1.6; }
        .info-box strong { color: #1f2937; }
        .verified-data { background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(52,211,153,0.1) 100%); border: 2px solid #10b981; padding: 20px; border-radius: 10px; margin-bottom: 25px; }
        .verified-data h3 { color: #059669; margin-bottom: 15px; font-size: 1.3em; }
        .data-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(229,231,235,0.5); }
        .data-item:last-child { border-bottom: none; }
        .data-label { font-weight: 600; color: #6b7280; }
        .data-value { color: #1f2937; font-weight: 500; }
        .error-box { background: linear-gradient(135deg, rgba(239,68,68,0.1) 0%, rgba(252,165,165,0.1) 100%); border: 2px solid #ef4444; padding: 20px; border-radius: 10px; color: #991b1b; margin-bottom: 25px; }
        .checkbox-group { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 25px; }
        .checkbox-group input[type="checkbox"] { width: 20px; height: 20px; margin-top: 2px; cursor: pointer; }
        .checkbox-group label { color: #374151; font-size: 0.95em; cursor: pointer; }
        .hidden { display: none; }
        .portrait { max-width: 150px; border-radius: 12px; margin: 15px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .loading { text-align: center; color: #3b82f6; padding: 20px; font-weight: 500; }
        .success-message { text-align: center; padding: 30px; }
        .success-message svg { width: 80px; height: 80px; margin-bottom: 20px; }
        .success-message h2 { color: #10b981; margin-bottom: 10px; }
        ul { line-height: 1.8; color: #4b5563; }
        
        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .bank-header { padding: 30px 20px; padding-top: 60px; }
            .bank-logo { font-size: 1.8em; }
            .bank-tagline { font-size: 0.95em; }
            .nav-links { position: static; justify-content: center; margin-bottom: 20px; width: 100%; }
            .nav-link { padding: 6px 12px; font-size: 0.85em; }
            .lang-select { padding: 6px 10px; font-size: 0.85em; }
            .card { padding: 25px 20px; }
            h2 { font-size: 1.4em; }
            h3 { font-size: 1.1em; }
            .step-indicator { padding: 0 10px; margin-bottom: 50px; }
            .step { font-size: 0.75em; padding: 5px; }
            .step::before { width: 24px; height: 24px; top: -35px; }
            .account-types { grid-template-columns: 1fr; gap: 15px; }
            .account-type { padding: 20px; }
            .account-type h3 { font-size: 1.2em; }
            .btn-primary { padding: 14px 24px; font-size: 15px; }
            .form-group input, .form-group select { padding: 10px 14px; font-size: 14px; }
            .verified-data { padding: 15px; }
            .data-item { flex-direction: column; gap: 5px; padding: 8px 0; }
            .portrait { max-width: 120px; }
        }
        
        @media (max-width: 480px) {
            .bank-logo { font-size: 1.5em; }
            .bank-tagline { font-size: 0.85em; }
            .nav-links { flex-direction: column; gap: 8px; }
            .nav-link { width: 100%; text-align: center; }
            .lang-select { width: 100%; text-align: center; }
            .card { padding: 20px 15px; }
            h2 { font-size: 1.2em; }
            .step { font-size: 0.7em; }
            .step::before { width: 20px; height: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="bank-header">
            <div class="nav-links">
                <select class="lang-select" data-lang-selector aria-label="Language">
                    <option value="en">EN</option>
                    <option value="am">አማ</option>
                </select>
                <a href="index.html" class="nav-link active" data-i18n="navOpenAccount">Open Account</a>
                <a href="signin.html" class="nav-link" data-i18n="navSignIn">Sign In</a>
            </div>
            <div class="bank-logo" data-i18n="bankName">TAMANGE BANK</div>
            <div class="bank-tagline" data-i18n="tagline">Secure Banking. Digital Identity. Trusted Service.</div>
        </div>

        <!-- Step 1: Welcome -->
        <div id="step-welcome" class="card">
            <h2 data-i18n="welcomeTitle">Welcome to Tamange Bank</h2>
            <div class="info-box">
                <p><strong data-i18n="digitalIdentityVerification">Digital Identity Verification</strong></p>
                <p data-i18n="welcomeIntro">Open your bank account in minutes using your mobile driver's license or digital ID. We'll securely verify your identity using the latest digital credentials technology.</p>
            </div>
            <h3 style="margin: 20px 0 10px;" data-i18n="whatYouNeed">What you'll need:</h3>
            <ul style="margin-left: 20px; color: #666;">
                <li data-i18n="needCredential">A mobile driver's license (mDL) or PhotoID digital credential</li>
                <li data-i18n="needAge">You must be 18 years or older</li>
                <li data-i18n="needContact">A valid email address and phone number</li>
            </ul>
            <button id="startBtn" class="btn-primary" style="margin-top: 30px;" data-i18n="startRegistration">Start Registration</button>
        </div>

        <!-- Step 2: Identity Verification -->
        <div id="step-verify" class="card hidden">
            <div class="step-indicator">
                <div class="step active" data-i18n="stepVerifyIdentity">1. Verify Identity</div>
                <div class="step" data-i18n="stepAccountDetails">2. Account Details</div>
                <div class="step" data-i18n="stepConfirmation">3. Confirmation</div>
            </div>
            <h2 data-i18n="verifyYourIdentity">Verify Your Identity</h2>
            <div class="info-box">
                <p data-i18n="verifyHelpText">Click the button below to share your digital credentials. We will request your name, date of birth, and document details.</p>
            </div>
            <button id="verifyBtn" class="btn-primary" data-i18n="verifyWithDigitalId">Verify with Digital ID</button>
            <div id="verifyResult" style="margin-top: 20px;"></div>
        </div>

        <!-- Step 3: Account Selection & Additional Details -->
        <div id="step-account" class="card hidden">
            <div class="step-indicator">
                <div class="step completed" data-i18n="stepVerifyIdentity">1. Verify Identity</div>
                <div class="step active" data-i18n="stepAccountDetails">2. Account Details</div>
                <div class="step" data-i18n="stepConfirmation">3. Confirmation</div>
            </div>
            <h2 data-i18n="completeRegistration">Complete Your Registration</h2>
            
            <div id="verifiedDataDisplay" class="verified-data"></div>

            <h3 style="margin-bottom: 15px;" data-i18n="chooseAccountType">Choose Account Type</h3>
            <div class="account-types">
                <div class="account-type" data-type="checking">
                    <h3 data-i18n="checkingAccount">Checking Account</h3>
                    <p data-i18n="checkingDesc">For everyday spending and bill payments</p>
                    <p class="highlight" data-i18n="checkingHighlight">No monthly fees</p>
                </div>
                <div class="account-type" data-type="savings">
                    <h3 data-i18n="savingsAccount">Savings Account</h3>
                    <p data-i18n="savingsDesc">Earn interest on your balance</p>
                    <p class="highlight" data-i18n="savingsHighlight">2.5% APY</p>
                </div>
            </div>

            <div class="form-group">
                <label for="email"><span data-i18n="emailAddress">Email Address</span> *</label>
                <input type="email" id="email" required placeholder="you@example.com" data-i18n-placeholder="placeholderEmail">
            </div>

            <div class="form-group">
                <label for="phone"><span data-i18n="phoneNumber">Phone Number</span> *</label>
                <input type="tel" id="phone" required placeholder="+1 (555) 123-4567" data-i18n-placeholder="placeholderPhone">
            </div>

            <div class="form-group">
                <label for="address"><span data-i18n="streetAddress">Street Address</span> *</label>
                <input type="text" id="address" required placeholder="123 Main Street" data-i18n-placeholder="placeholderAddress">
            </div>

            <div class="form-group">
                <label for="city"><span data-i18n="city">City</span> *</label>
                <input type="text" id="city" required placeholder="New York" data-i18n-placeholder="placeholderCity">
            </div>

            <div class="form-group">
                <label for="state"><span data-i18n="state">State</span> <small>(<span data-i18n="optional">Optional</span>)</small></label>
                <input type="text" id="state" placeholder="NY" data-i18n-placeholder="placeholderState">
            </div>

            <div class="form-group">
                <label for="zipCode"><span data-i18n="zipCode">ZIP Code</span> <small>(<span data-i18n="optional">Optional</span>)</small></label>
                <input type="text" id="zipCode" placeholder="10001" data-i18n-placeholder="placeholderZip">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="terms" required>
                <label for="terms" data-i18n="termsAgree">I agree to the Terms and Conditions and Privacy Policy</label>
            </div>

            <button id="submitBtn" class="btn-primary" disabled data-i18n="createAccount">Create Account</button>
        </div>

        <!-- Step 4: Success -->
        <div id="step-success" class="card hidden">
            <div class="step-indicator">
                <div class="step completed" data-i18n="stepVerifyIdentity">1. Verify Identity</div>
                <div class="step completed" data-i18n="stepAccountDetails">2. Account Details</div>
                <div class="step completed" data-i18n="stepConfirmation">3. Confirmation</div>
            </div>
            <div class="success-message">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#10b981"/>
                    <path d="M7 13l3 3 7-7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h2 data-i18n="accountCreatedSuccessfully">Account Created Successfully!</h2>
            </div>
            <div id="accountDetails" class="verified-data" style="margin-top: 30px;"></div>
            <div class="info-box" style="margin-top: 20px;">
                <p><strong data-i18n="nextSteps">Next Steps:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li data-i18n="nextCheckEmail">Check your email for account confirmation</li>
                    <li data-i18n="nextDownloadApp">Download the Tamange Bank mobile app</li>
                    <li data-i18n="nextSetupOnline">Set up your online banking credentials</li>
                    <li data-i18n="nextFirstDeposit">Make your first deposit</li>
                </ul>
            </div>
        </div>
    </div>
    <script type="module">
        import { initI18n } from './i18n.js';
        initI18n();
    </script>
    <script type="module" src="script.js"></script>
</body>
</html>
